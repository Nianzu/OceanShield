import requests

#vessel historical track - this gets back boats in area-
api_key1 = "57d057ddd09102f9dbadc848d217e2efa4f5ab5a"

#vessel particulars: get api key from: VD02
api_key2 = "af9e6fa192622ab25fb5a43c0219293bfec3e5c0"
    

#raw data you have
latitude = 25.25
longitude = -122.25

#search parameters
radius = .25

text = [["477004700","9484405","0","179","-122.4997","25.40754","121","121","2022-10-01T07:11:35","684943"],["477004700","9484405","0","180","-122.4883","25.40134","120","120","2022-10-01T07:13:59","684943"],["477004700","9484405","0","180","-122.4775","25.39549","120","120","2022-10-01T07:16:17","684943"],["477004700","9484405","0","181","-122.4626","25.38744","121","120","2022-10-01T07:19:24","684943"],["477004700","9484405","0","180","-122.4518","25.38156","120","120","2022-10-01T07:21:40","684943"],["477004700","9484405","0","179","-122.4389","25.3746","120","119","2022-10-01T07:24:23","684943"],["477004700","9484405","0","180","-122.4261","25.36774","120","121","2022-10-01T07:26:58","684943"],["477004700","9484405","0","180","-122.4154","25.362","120","121","2022-10-01T07:29:17","684943"],["477004700","9484405","0","179","-122.4048","25.3562","120","119","2022-10-01T07:31:34","684943"],["477004700","9484405","0","179","-122.394","25.35037","121","120","2022-10-01T07:33:52","684943"],["477004700","9484405","0","179","-122.3831","25.34451","120","120","2022-10-01T07:36:11","684943"],["477004700","9484405","0","178","-122.3728","25.33897","120","120","2022-10-01T07:38:22","684943"],["477004700","9484405","0","179","-122.3624","25.3333","121","120","2022-10-01T07:40:35","684943"],["477004700","9484405","0","178","-122.3516","25.3274","120","120","2022-10-01T07:42:53","684943"],["477004700","9484405","0","178","-122.3404","25.32131","121","120","2022-10-01T07:45:16","684943"],["477004700","9484405","0","178","-122.3296","25.31534","121","120","2022-10-01T07:47:34","684943"],["477004700","9484405","0","178","-122.3193","25.30968","121","121","2022-10-01T07:49:46","684943"],["477004700","9484405","0","179","-122.3085","25.30373","120","120","2022-10-01T07:52:05","684943"],["477004700","9484405","0","180","-122.2977","25.29766","121","120","2022-10-01T07:54:23","684943"],["477004700","9484405","0","180","-122.2869","25.29165","122","120","2022-10-01T07:56:40","684943"],["477004700","9484405","0","180","-122.2762","25.28563","121","120","2022-10-01T07:58:58","684943"],["477004700","9484405","0","178","-122.2649","25.27932","121","120","2022-10-01T08:01:23","684943"],["477004700","9484405","0","178","-122.2529","25.27263","121","120","2022-10-01T08:03:58","684943"],["477004700","9484405","0","178","-122.2421","25.2666","122","120","2022-10-01T08:06:17","684943"],["477004700","9484405","0","179","-122.2314","25.26063","122","120","2022-10-01T08:08:35","684943"],["477004700","9484405","0","179","-122.2202","25.25445","121","120","2022-10-01T08:10:58","684943"],["477004700","9484405","0","178","-122.2089","25.24819","121","120","2022-10-01T08:13:23","684943"],["477004700","9484405","0","178","-122.1982","25.24224","122","120","2022-10-01T08:15:40","684943"],["477004700","9484405","0","178","-122.182","25.23323","121","120","2022-10-01T08:19:10","684943"],["477004700","9484405","0","177","-122.1709","25.22697","121","120","2022-10-01T08:21:34","684943"],["477004700","9484405","0","177","-122.1606","25.22127","121","120","2022-10-01T08:23:47","684943"],["477004700","9484405","0","179","-122.1495","25.21499","122","120","2022-10-01T08:26:11","684943"],["477004700","9484405","0","179","-122.1355","25.20721","121","120","2022-10-01T08:29:11","684943"],["477004700","9484405","0","177","-122.1234","25.20053","121","120","2022-10-01T08:31:47","684943"],["477004700","9484405","0","177","-122.1003","25.18775","120","120","2022-10-01T08:36:46","684943"],["477004700","9484405","0","177","-122.0887","25.18136","120","120","2022-10-01T08:39:16","684943"],["477004700","9484405","0","177","-122.078","25.17546","121","120","2022-10-01T08:41:34","684943"],["477004700","9484405","0","177","-122.0549","25.16273","121","120","2022-10-01T08:46:34","684943"],["477004700","9484405","0","178","-122.0452","25.15731","121","120","2022-10-01T08:48:40","684943"],["477004700","9484405","0","179","-122.0348","25.15154","121","120","2022-10-01T08:50:53","684943"],["477004700","9484405","0","179","-122.024","25.14557","121","119","2022-10-01T08:53:11","684943"],["477004700","9484405","0","179","-122.0129","25.13944","121","120","2022-10-01T08:55:34","684943"],["477004700","9484405","0","179","-122.002","25.13347","120","120","2022-10-01T08:57:53","684943"]]
ship_info = [["477004700","9484405","COSCO VENICE","","2013","32.25","49973","","VRME4","HK","11","261.1","150 t\/day at 24.30 kn","","24.5","","CHINA COSCO HOLDINGS CO CCHC","COSCO SHIPPING LINES CO LTD","CONTAINER SHIP"]]

#returns name of company that owns ship
def parse_ID(info, data_type):
    data = info[0][16]
    print(data)
    return(data)

#returns list of Boat IMOs in string form
def get_boat_IDs(text, key):
    IDs = []
    KEY = key
    for boat in text:
        if boat[1] not in IDs:
            IDs.append(boat[1])
    print(IDs)
    web = str.format('https://services.marinetraffic.com/api/vesselmasterdata/{0}?v=1&imo={1}&interval=minutes&protocol=json&page=1'.format(KEY, IDs))
    req = requests.get(web)
    response = req.text
    print(response)
    parse_ID(response)
    

def get_boats_in_area(latitude, longitude, radius, api_key1, api_key2):
    #set box for looking for boats
    KEY = api_key1
    KEY2 = api_key2
    MAXLAT = latitude + radius
    MINLAT = latitude - radius
    MAXLON = longitude + radius
    MINLON = longitude - radius
    
    web = str.format('https://services.marinetraffic.com/api/exportvesseltrack/{4}%20?v=3&days=1&MINLAT={0}&MAXLAT={1}&MINLON={2}&MAXLON={3}&msgtype=simple&protocol=json'.format(MINLAT, MAXLAT, MINLON, MAXLON, KEY))
    req = requests.get(web)
    response = req.text
    print(response)
    get_boat_IDs(response, KEY2)
    
    
#parse_ID(ship_info)    
#get_boat_IDs(text, api_key2)
#get_boats_in_area(latitude, longitude, radius, api_key1)